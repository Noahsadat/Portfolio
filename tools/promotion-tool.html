<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
    <title>Aktionstitel Generator</title>
</head>
<body>
    <div class="container my-5 shadow-lg p-3 mb-5 bg-body rounded">
        <h5>What is the title of your campaign?</h5>
        <form id="titleForm" class="row g-3 needs-validation" novalidate>
            <div class="col-md-4">
                <label for="deTitle" class="form-label">Promotion title (DE):</label>
                <input type="text" class="form-control" id="deTitle" name="deTitle" required>
                <div class="invalid-feedback">
                    Please enter the title.
                </div>
            </div>
            <div class="col-md-4">
                <label for="frTitle" class="form-label">Promotion title (FR):</label>
                <input type="text" class="form-control" id="frTitle" name="frTitle" required>
                <div class="invalid-feedback">
                    Please enter the title.
                </div>
            </div>
            <div class="col-md-4">
                <label for="nlTitle" class="form-label">Promotion title (NL):</label>
                <input type="text" class="form-control" id="nlTitle" name="nlTitle" required>
                <div class="invalid-feedback">
                    Please enter the title.
                </div>
            </div>
            <div class="col-md-4">
                <label for="enTitle" class="form-label">Promotion title (EN):</label>
                <input type="text" class="form-control" id="enTitle" name="enTitle" required>
                <div class="invalid-feedback">
                    Please enter the title.
                </div>
            </div>
            <div class="col-md-4">
                <label for="itTitle" class="form-label">Promotion title (IT):</label>
                <input type="text" class="form-control" id="itTitle" name="itTitle" required>
                <div class="invalid-feedback">
                    Please enter the title.
                </div>
            </div>
            
            <h5>Description?(optional)</h5>
            <div class="col-md-4">
                <label for="deDescription" class="form-label">Description (DE):</label>
                <input type="text" class="form-control" id="deDescription" name="deDescription" required>
                <div class="invalid-feedback">
                    Please enter the title.
                </div>
            </div>
            <div class="col-md-4">
                <label for="frDescription" class="form-label">Description (FR):</label>
                <input type="text" class="form-control" id="frDescription" name="frDescription" required>
                <div class="invalid-feedback">
                    Please enter the title.
                </div>
            </div>
            <div class="col-md-4">
                <label for="nlDescription" class="form-label">Description (NL):</label>
                <input type="text" class="form-control" id="nlDescription" name="nlDescription" required>
                <div class="invalid-feedback">
                    Please enter the title.
                </div>
            </div>
            <div class="col-md-4">
                <label for="enDescription" class="form-label">Description (EN):</label>
                <input type="text" class="form-control" id="enDescription" name="enDescription" required>
                <div class="invalid-feedback">
                    Please enter the title.
                </div>
            </div>
            <div class="col-md-4">
                <label for="itDescription" class="form-label">Description (IT):</label>
                <input type="text" class="form-control" id="itDescription" name="itDescription" required>
                <div class="invalid-feedback">
                    Please enter the title.
                </div>
            </div>

            <div class="col-12">
                <label class="form-label h5">Campaign period</label>
            </div>
            <div class="col-md-3">
                <label for="startDate" class="form-label">from:</label>
                <input type="text" class="form-control datepicker" id="startDate" required>
                <div class="invalid-feedback">
                    Bitte geben Sie ein Startdatum ein.
                </div>
            </div>
            <div class="col-md-3">
                <label for="endDate" class="form-label">to:</label>
                <input type="text" class="form-control datepicker" id="endDate" required>
                <div class="invalid-feedback">
                    Bitte geben Sie ein Enddatum ein.
                </div>
            </div>

            <div class="col-12">
                <label class="form-label h5">Can the campaign be combined?</label><br>
                <button type="button" class="btn btn-outline-secondary" onclick="updateCombinability(false)">not combinable</button>
                <button type="button" class="btn btn-outline-secondary" onclick="updateCombinability(true)">combinable</button>
            </div>
    
            <div class="col-12">
                <label class="form-label h5">Is the promotion excluded from categories or brands?</label><br>
                <div class="btn-group" role="group" aria-label="Exclusion options">
                    
        <button type="button" class="btn btn-outline-secondary exclusion-option" 
        onclick="updateExclusions(this)"
        data-de="Automobile"
        data-fr="Automobile"
        data-nl="Automotive">Automotive</button>

        <button type="button" class="btn btn-outline-secondary exclusion-option" 
        onclick="updateExclusions(this)"
        data-de="Bikes"
        data-fr="Vélos"
        data-nl="Fietsen">Bikes</button>

        <button type="button" class="btn btn-outline-secondary exclusion-option" 
        onclick="updateExclusions(this)"
        data-de="Laptops"
        data-fr="Ordinateurs portables"
        data-nl="Laptops">Laptops</button>

        <button type="button" class="btn btn-outline-secondary exclusion-option" 
        onclick="updateExclusions(this)"
        data-de="Drohnen"
        data-fr="Drones"
        data-nl="Drones">Drones</button>

        <button type="button" class="btn btn-outline-secondary exclusion-option" 
        onclick="updateExclusions(this)"
        data-de="Kleidung"
        data-fr="Vêtements"
        data-nl="Kleding">Clothing</button>

        <button type="button" class="btn btn-outline-secondary exclusion-option" 
        onclick="updateExclusions(this)"
        data-de="Software"
        data-fr="Logiciel"
        data-nl="Software">Software</button>

        <button type="button" class="btn btn-outline-secondary exclusion-option" 
        onclick="updateExclusions(this)"
        data-de="Dateien"
        data-fr="Fichiers"
        data-nl="Bestanden">Files</button>

                  </div><br>
                <div class="btn-group mt-3" role="group" aria-label="Exclusion options">
                    <button type="button" class="btn btn-outline-secondary exclusion-option" 
        onclick="updateExclusions(this)"
        data-de="Brand one"
        data-fr="Brand one"
        data-nl="Brand one">Brand one</button>

        <button type="button" class="btn btn-outline-secondary exclusion-option" 
        onclick="updateExclusions(this)"
        data-de="Brand two"
        data-fr="Brand two"
        data-nl="Brand two">Brand two</button>

        <button type="button" class="btn btn-outline-secondary exclusion-option" 
        onclick="updateExclusions(this)"
        data-de="Brand three"
        data-fr="Brand three"
        data-nl="Brand three">Brand three</button>

        <button type="button" class="btn btn-outline-secondary exclusion-option" 
        onclick="updateExclusions(this)"
        data-de="Brand four"
        data-fr="Brand four"
        data-nl="Brand four">Brand four</button>

        <button type="button" class="btn btn-outline-secondary exclusion-option" 
        onclick="updateExclusions(this)"
        data-de="brand five"
        data-fr="brand five"
        data-nl="brand five">brand five</button>
                </div>
            </div>
            
        </form>
        <div id="result" class="mt-3"></div>
    </div>
    





    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
<script>
    $(document).ready(function() {
        // Initialisiert das Datepicker-Widget für die Datumsfelder
        $('.datepicker').datepicker({
            format: 'dd.mm.yyyy',
            autoclose: true
        });
    });

    let exclusions = [];
    let isCombinable = true; // Standardmäßig ist die Aktion kombinierbar

    function updateExclusions(buttonElement) {
    let selected = buttonElement.getAttribute('data-de');
    let selectedFr = buttonElement.getAttribute('data-fr');
    let selectedNl = buttonElement.getAttribute('data-nl');

    if (selected === 'Nein') {
        exclusions = [{de: 'Nein', fr: 'Non', nl: 'Nee'}];
    } else {
        const index = exclusions.findIndex(ex => ex.de === selected);
        if (index === -1) {
            exclusions.push({de: selected, fr: selectedFr, nl: selectedNl});
        } else {
            exclusions.splice(index, 1);
        }
    }
    updateButtons();
    processTitles();
}

function translateWithDeepL(text, targetLang, apiKey) {
    const url = "https://api-free.deepl.com/v2/translate";

    const params = new URLSearchParams();
    params.append('auth_key', apiKey);
    params.append('text', text);
    params.append('target_lang', targetLang);

    return fetch(url, {
        method: 'POST',
        body: params
    })
    .then(response => response.json())
    .then(data => {
        if (data.translations && data.translations.length > 0) {
            return data.translations[0].text;
        } else {
            throw new Error('Translation failed or no translation returned.');
        }
    })
    .catch(error => {
        console.error('Error translating text:', error);
        return ''; // Return empty string or handle error appropriately
    });
}

document.getElementById('deTitle').addEventListener('change', function() {
    const titleText = this.value;
    const apiKey = 'cde1269e-de07-4498-9bc7-c901ef5f9ea7:fx';  // Replace with your actual DeepL API key

    // Translate title to French
    translateWithDeepL(titleText, 'FR', apiKey).then(translatedText => {
        document.getElementById('frTitle').value = translatedText; // Make sure this matches the ID in your HTML
    });

    // Translate title to Dutch
    translateWithDeepL(titleText, 'NL', apiKey).then(translatedText => {
        document.getElementById('nlTitle').value = translatedText; // Make sure this matches the ID in your HTML
    });

    // Translate title to English
    translateWithDeepL(titleText, 'EN', apiKey).then(translatedText => {
        document.getElementById('enTitle').value = translatedText; // Make sure this matches the ID in your HTML
    });
    
    // Translate title to Italian
    translateWithDeepL(titleText, 'IT', apiKey).then(translatedText => {
        document.getElementById('itTitle').value = translatedText; // Make sure this matches the ID in your HTML
    });
});


document.getElementById('deDescription').addEventListener('change', function() {
    const deText = this.value;
    const apiKey = 'cde1269e-de07-4498-9bc7-c901ef5f9ea7:fx';  // Replace with your actual DeepL API key

    // Translate to French
    translateWithDeepL(deText, 'FR', apiKey).then(translatedText => {
        document.getElementById('frDescription').value = translatedText;
    });

    // Translate to Dutch
    translateWithDeepL(deText, 'NL', apiKey).then(translatedText => {
        document.getElementById('nlDescription').value = translatedText;
    });

    // Translate to English
    translateWithDeepL(deText, 'EN', apiKey).then(translatedText => {
        document.getElementById('enDescription').value = translatedText;
    });

    // Translate to English
    translateWithDeepL(deText, 'IT', apiKey).then(translatedText => {
        document.getElementById('itDescription').value = translatedText;
    });
});


    function updateButtons() {
        // Aktualisiert die Zustände der Buttons basierend auf aktuellen Ausschlüssen
        document.querySelectorAll('.exclusion-option').forEach(button => {
            if (exclusions.length === 1 && exclusions[0] === 'nein') {
                button.disabled = button.textContent !== 'Nein';
            } else {
                button.disabled = false;
            }
        });
    }

    function updateCombinability(combinable) {
        // Aktualisiert die Kombinierbarkeit der Aktion
        isCombinable = combinable;
        processTitles();
    }

    function processTitles() {
    const deTitle = document.getElementById('deTitle').value;
    const frTitle = document.getElementById('frTitle').value;
    const nlTitle = document.getElementById('nlTitle').value;
    const enTitle = document.getElementById('enTitle').value;
    const itTitle = document.getElementById('itTitle').value;
    const deDescription = document.getElementById('deDescription').value;
    const frDescription = document.getElementById('frDescription').value;
    const nlDescription = document.getElementById('nlDescription').value;
    const enDescription = document.getElementById('enDescription').value;
    const itDescription = document.getElementById('itDescription').value;
    const startDate = document.getElementById('startDate').value;
    const endDate = document.getElementById('endDate').value;

    // Grundlegenden Text für jede Sprache vorbereiten
    let exclusionTextDe = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin tempor, magna sed molestie ultricies, felis odio facilisis justo.";
    let exclusionTextFr = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Plus taxes applicables. Cette offre est valable uniquement pour les articles sélectionnés.";
    let exclusionTextNl = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Exclusief wettelijke omzetbelasting. Deze aanbieding geldt alleen voor geselecteerde artikelen.";
    let exclusionTextEn = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Plus applicable taxes. This offer is only valid for selected items.";
    let exclusionTextIt = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Più tasse applicabili. Questa offerta è valida solo per gli articoli selezionati.";

    

    let combinabilityTextDe = !isCombinable ? " Lorem ipsum dolor sit amet. Nicht kombinierbar. " : "";
    let combinabilityTextFr = !isCombinable ? " Lorem ipsum dolor sit amet. Non cumulable. " : "";
    let combinabilityTextNl = !isCombinable ? " Lorem ipsum dolor sit amet. Niet combineerbaar. " : "";
    let combinabilityTextEn = !isCombinable ? " Lorem ipsum dolor sit amet. Not combinable. " : "";
    let combinabilityTextIt = !isCombinable ? " Lorem ipsum dolor sit amet. Non cumulabile. " : "";

    if (exclusions.length > 0 && exclusions[0].de !== 'Nein') {
        let categoryListDe = exclusions.map(ex => ex.de).join(', ');
        let categoryListFr = exclusions.map(ex => ex.fr).join(', ');
        let categoryListNl = exclusions.map(ex => ex.nl).join(', ');
        let categoryListEn = exclusions.map(ex => ex.en).join(', ');
        let categoryListIt = exclusions.map(ex => ex.it).join(', ');

        exclusionTextDe += ` <br><br>Ausgeschlossen sind Artikel aus der Kategorie/Marke: ${categoryListDe}.`;
        exclusionTextFr += ` <br><br>Sont exclus les articles de la catégorie/marque: ${categoryListFr}.`;
        exclusionTextNl += ` <br><br>Uitgesloten zijn artikelen uit/van de volgende categorieën/merken: ${categoryListNl}.`;
        exclusionTextEn += ` <br><br>Items from following Categories/Brands are excluded: ${categoryListEn}.`;
        exclusionTextIt += ` <br><br>Sono esclusi gli articoli della categoria/marca: ${categoryListIt}.`;
    }

    document.getElementById('result').innerHTML = `
    
    <div class="container text-center my-3">
        <button type="button" class="btn btn-primary" onclick="copyToClipboard()">Copy Text</button>
    <button type="button" class="btn btn-secondary" onclick="resetForm()">Reset</button>
    <button type="button" class="btn btn-success" onclick="downloadXML()">Download XML-File</button>
    </div>
    

    <div class="alert alert-success">
        <strong>German:</strong><br> Promotion title: ${deTitle}<br>
        Description: ${deDescription}<br>
        Campaign period: Diese Aktion ist gültig vom ${startDate} bis zum ${endDate}<br>
        Aktionsregeln: ${combinabilityTextDe}${exclusionTextDe}
    </div>
    <div class="alert alert-success">
        <strong>French:</strong><br> Promotion title: ${frTitle}<br>
        Description: ${frDescription}<br>
        Campaign period: Promotion valable du ${startDate} au ${endDate}<br>
        Règles de promotion: ${combinabilityTextFr}${exclusionTextFr}
    </div>
    <div class="alert alert-success">
        <strong>Dutch:</strong><br> Promotion title: ${nlTitle}<br>
        Description: ${nlDescription}<br>
        Campaign period: Actie geldig van ${startDate} tot en met ${endDate}<br>
        Promotieregels: ${combinabilityTextNl}${exclusionTextNl}
    </div>
    <div class="alert alert-success">
        <strong>English:</strong><br> Promotion title: ${enTitle}<br>
        Description: ${enDescription}<br>
        Campaign period: This promotion is valid from ${startDate} to ${endDate}<br>
        Promotion rules: ${combinabilityTextEn}${exclusionTextEn}
    </div>
    <div class="alert alert-success">
        <strong>Italian:</strong><br> Promotion title: ${itTitle}<br>
        Description: ${itDescription}<br>
        Campaign period: Questa promozione è valida da ${startDate} a ${endDate}<br>
        Regole della promozione: ${combinabilityTextIt}${exclusionTextIt}
    </div>
    `;
}

    
    function resetForm() {
    document.getElementById('titleForm').reset();
    exclusions = [];
    document.querySelectorAll('.exclusion-option').forEach(button => {
        button.disabled = false; // Re-enable all buttons
    });
    document.getElementById('result').innerHTML = '';
}
function copyToClipboard() {
    const resultElement = document.getElementById('result');
    const textToCopy = Array.from(resultElement.querySelectorAll('.alert')).map(alert => alert.innerText).join('\n\n');

    // Use a temporary textarea to facilitate copying
    const textarea = document.createElement('textarea');
    textarea.textContent = textToCopy;
    textarea.style.position = 'fixed';  // Prevents scrolling to bottom
    document.body.appendChild(textarea);
    textarea.select();

    try {
        document.execCommand('copy');
        alert('text has been copied!!');
    } catch (err) {
        console.error('Fehler beim Kopieren des Textes: ', err);
    }

    document.body.removeChild(textarea);
}

function generatePromotionId() {
    const length = 24; // Total desired length of the ID
    const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
    let result = '';
    const underscorePosition = Math.floor(Math.random() * (length - 1)); // Position to place the underscore

    for (let i = 0; i < length; i++) {
        if (i === underscorePosition) {
            result += '_';
        } else {
            result += characters.charAt(Math.floor(Math.random() * characters.length));
        }
    }
    return result;
}

function formatDate(dateString) {
    // This function assumes dateString is in "dd.mm.yyyy" format
    const parts = dateString.split('.');
    const day = parts[0];
    const month = parts[1];
    const year = parts[2];

    // Creating "dd-mm-yyyy" format
    const format1 = `${day}-${month}-${year}`;

    // Creating "yyyy-mm-dd" format
    const format2 = `${year}-${month}-${day}`;

    return { format1, format2 };
}

let fullActionRulesTextDe, fullActionRulesTextFr, fullActionRulesTextNl;

function downloadXML() {
    const promotionId = generatePromotionId(); // Generate a unique promotion ID
    const deTitle = document.getElementById('deTitle').value;
    const frTitle = document.getElementById('frTitle').value;
    const nlTitle = document.getElementById('nlTitle').value;
    const enTitle = document.getElementById('enTitle').value;
    const itTitle = document.getElementById('itTitle').value;
    const deDescription = document.getElementById('deDescription').value;
    const frDescription = document.getElementById('frDescription').value;
    const nlDescription = document.getElementById('nlDescription').value;
    const enDescription = document.getElementById('enDescription').value;
    const itDescription = document.getElementById('itDescription').value;
    const startDate = document.getElementById('startDate').value;
    const endDate = document.getElementById('endDate').value;
    const formattedStartDate = formatDate(startDate);
    const formattedEndDate = formatDate(endDate);

    // Deutsch
    let combinabilityTextDe = isCombinable ? "" : "Diese Aktion ist nicht kombinierbar.";
    let exclusionTextDe = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin tempor, magna sed molestie ultricies, felis odio facilisis justo.";
    
    // Französisch
    let combinabilityTextFr = isCombinable ? "" : "Cette promotion n'est pas combinable avec d'autres promotions.";
    let exclusionTextFr = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Plus taxes applicables. Cette offre est valable uniquement pour les articles sélectionnés.";

    // Niederländisch
    let combinabilityTextNl = isCombinable ? "" : "Deze actie is niet combineerbaar met andere acties.";
    let exclusionTextNl = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Exclusief wettelijke omzetbelasting. Deze aanbieding geldt alleen voor geselecteerde artikelen.";

    // Englisch
    let combinabilityTextEn = isCombinable ? "" : "This promotion cannot be combined with other promotions.";
    let exclusionTextEn = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Plus applicable taxes. This offer is only valid for selected items.";

    // Italienisch
    let combinabilityTextIt = isCombinable ? "" : "Questa promozione non è cumulabile con altre promozioni.";
    let exclusionTextIt = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Più tasse applicabili. Questa offerta è valida solo per gli articoli selezionati.";


    const xmlContent = `Example-file
`;

    const blob = new Blob([xmlContent], { type: 'application/xml' });
    const url = URL.createObjectURL(blob);
    const link = document.createElement('a');
    link.href = url;
    link.download = 'Aktionsvorlage.xml';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    URL.revokeObjectURL(url);
}




</script>





    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>